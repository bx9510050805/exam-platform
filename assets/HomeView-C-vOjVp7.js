import{r as N,c as A,J as a,K as L,o as m,k as n,f as o,e as w,j as t,g as p,u as s,F as I,L as j,M as F,t as C,N as H,O as M,P as E,Q as V,R as B,S as D,T as z,U as J}from"./vendor-BT68RlnH.js";import{d as K,s as T,_ as U,u as O,a as P,b as Q}from"./index-UCzg-GgR.js";const q=K("notification",()=>{const v=N([]),u=N(0),f=async()=>{try{const e=await T.get("/notifications");v.value=(e==null?void 0:e.data)||[]}catch(e){console.error("获取通知失败:",e),v.value=[]}},r=async()=>{try{const e=await T.get("/notifications/unread-count");u.value=(e==null?void 0:e.data)||0}catch(e){console.error("获取未读数量失败:",e),u.value=0}};return{notifications:v,unreadCount:u,fetchNotifications:f,fetchUnreadCount:r,markAsRead:async e=>{try{await T.put(`/notifications/${e}/read`),await r()}catch(l){throw console.error("标记已读失败:",l),l}}}}),G={class:"notification-dropdown"},W={class:"dropdown-header"},X={key:0,class:"notification-list"},Y=["onClick"],Z={class:"notification-title"},ee={class:"notification-content"},te={class:"notification-time"},ne={key:1,class:"empty-notification"},oe={__name:"NotificationBadge",setup(v){const u=O(),f=q(),{notifications:r,unreadCount:x}=P(f),{fetchNotifications:e,markAsRead:l}=f,d=A(()=>[...r.value].sort((i,c)=>new Date(c.createTime)-new Date(i.createTime)).slice(0,5)),b=i=>new Date(i).toLocaleTimeString(),k=()=>{u.push("/notifications")},$=async i=>{if(i.isRead||await l(i.id),!i.relatedId)return u.push("/notifications");switch(i.type){case"exam":u.push(`/exams/${i.relatedId}`);break;case"grade":u.push(`/exams/${i.relatedId}/result`);break;default:u.push("/notifications")}};return onMounted(async()=>{await e()}),(i,c)=>{const h=a("el-icon"),R=a("el-badge"),y=a("el-button"),S=a("el-popover");return m(),L(S,{placement:"bottom",width:350,trigger:"click"},{reference:n(()=>[t(R,{value:s(x),max:99,class:"notification-badge",hidden:s(x)===0},{default:n(()=>[t(h,{size:20},{default:n(()=>[t(s(H))]),_:1})]),_:1},8,["value","hidden"])]),default:n(()=>[o("div",G,[o("div",W,[c[1]||(c[1]=o("span",null,"最新通知",-1)),t(y,{type:"text",onClick:k},{default:n(()=>c[0]||(c[0]=[p("查看全部")])),_:1})]),s(r).length>0?(m(),w("div",X,[(m(!0),w(I,null,j(d.value,_=>(m(),w("div",{key:_.id,class:F(["notification-item",{unread:!_.isRead}]),onClick:g=>$(_)},[o("div",Z,C(_.title),1),o("div",ee,C(_.content),1),o("div",te,C(b(_.createTime)),1)],10,Y))),128))])):(m(),w("div",ne," 暂无新消息 "))])]),_:1})}}},ae=U(oe,[["__scopeId","data-v-5a614bf8"]]),se={alt:"首页图片"},le={class:"header-content"},ie={class:"right-menu"},de={__name:"HomeView",setup(v){const u=N("path/to/your/image.jpg"),f=Q(),r=N(!1);return(x,e)=>{const l=a("el-icon"),d=a("el-menu-item"),b=a("el-sub-menu"),k=a("el-menu"),$=a("el-aside"),i=a("el-button"),c=a("el-header"),h=a("router-view"),R=a("el-main"),y=a("el-container"),S=a("el-drawer"),_=E("lazy");return m(),w(I,null,[o("div",null,[e[2]||(e[2]=o("h1",null,"首页",-1)),M(o("img",se,null,512),[[_,u.value]])]),t(y,{class:"main-container"},{default:n(()=>[t($,{width:"200px",class:"hidden-sm-and-down"},{default:n(()=>[e[9]||(e[9]=o("div",{class:"logo"},[o("h2",null,"在线考试平台")],-1)),t(k,{router:"","default-active":x.$route.path,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},{default:n(()=>[t(d,{index:"/dashboard"},{default:n(()=>[t(l,null,{default:n(()=>[t(s(V))]),_:1}),e[3]||(e[3]=o("span",null,"仪表盘",-1))]),_:1}),t(b,{index:"exam-management"},{title:n(()=>[t(l,null,{default:n(()=>[t(s(B))]),_:1}),e[4]||(e[4]=o("span",null,"考试管理",-1))]),default:n(()=>[t(d,{index:"/exams"},{default:n(()=>e[5]||(e[5]=[p("考试列表")])),_:1}),t(d,{index:"/exams/create"},{default:n(()=>e[6]||(e[6]=[p("创建考试")])),_:1})]),_:1}),t(d,{index:"/users"},{default:n(()=>[t(l,null,{default:n(()=>[t(s(D))]),_:1}),e[7]||(e[7]=o("span",null,"用户管理",-1))]),_:1}),t(d,{index:"/settings"},{default:n(()=>[t(l,null,{default:n(()=>[t(s(z))]),_:1}),e[8]||(e[8]=o("span",null,"系统设置",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),t(y,null,{default:n(()=>[t(c,{class:"header"},{default:n(()=>{var g;return[o("div",le,[t(l,{class:"mobile-menu",onClick:e[0]||(e[0]=ue=>r.value=!0)},{default:n(()=>[t(s(J))]),_:1}),e[11]||(e[11]=o("span",{class:"logo-text"},"在线考试平台",-1)),o("div",ie,[t(ae),o("span",null,C(((g=s(f).user)==null?void 0:g.username)||"未登录用户"),1),t(i,{onClick:s(f).logout},{default:n(()=>e[10]||(e[10]=[p("退出")])),_:1},8,["onClick"])])])]}),_:1}),t(R,{class:"main-content"},{default:n(()=>[t(h)]),_:1})]),_:1})]),_:1}),t(S,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=g=>r.value=g),direction:"ltr",size:"70%"},{default:n(()=>[t(k,{router:""},{default:n(()=>[t(d,{index:"/dashboard"},{default:n(()=>[t(l,null,{default:n(()=>[t(s(V))]),_:1}),e[12]||(e[12]=o("span",null,"仪表盘",-1))]),_:1}),t(b,{index:"exam-management"},{title:n(()=>[t(l,null,{default:n(()=>[t(s(B))]),_:1}),e[13]||(e[13]=o("span",null,"考试管理",-1))]),default:n(()=>[t(d,{index:"/exams"},{default:n(()=>e[14]||(e[14]=[p("考试列表")])),_:1}),t(d,{index:"/exams/create"},{default:n(()=>e[15]||(e[15]=[p("创建考试")])),_:1})]),_:1}),t(d,{index:"/users"},{default:n(()=>[t(l,null,{default:n(()=>[t(s(D))]),_:1}),e[16]||(e[16]=o("span",null,"用户管理",-1))]),_:1}),t(d,{index:"/settings"},{default:n(()=>[t(l,null,{default:n(()=>[t(s(z))]),_:1}),e[17]||(e[17]=o("span",null,"系统设置",-1))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},_e=U(de,[["__scopeId","data-v-1a6cab14"]]);export{_e as default};
